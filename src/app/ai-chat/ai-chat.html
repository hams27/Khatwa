<!-- ================= AI CHAT WIDGET ================= -->

<!-- ุฒุฑุงุฑ ุงูุนูู -->
<div class="chat-fab" (click)="toggleChat()" [class.active]="isChatOpen">
  <div class="fab-icon">
    <svg *ngIf="!isChatOpen" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
    </svg>
    <svg *ngIf="isChatOpen" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
      <line x1="18" y1="6" x2="6" y2="18"/>
      <line x1="6" y1="6" x2="18" y2="18"/>
    </svg>
  </div>
  <div class="fab-pulse"></div>
  <!-- ููุทุฉ ุงูุฅุดุนุงุฑ -->
  <div class="fab-badge" *ngIf="!isChatOpen && hasNewMessage">1</div>
</div>

<!-- ูุงูุฐุฉ ุงูุดุงุช -->
<div class="chat-window" [class.open]="isChatOpen">
  
  <!-- ุงูููุฏุฑ -->
  <div class="chat-header">
    <div class="chat-header-info">
      <div class="chat-avatar">
        <span>AI</span>
        <div class="avatar-online"></div>
      </div>
      <div>
        <div class="chat-name">ูุณุงุนุฏ ุฎุทูุฉ</div>
        <div class="chat-status">
          <span class="status-dot"></span>
          ูุชุงุญ ุงูุขู
        </div>
      </div>
    </div>
    <button class="chat-close-btn" (click)="toggleChat()">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
  </div>

  <!-- ููุทูุฉ ุงูุฑุณุงุฆู -->
  <div class="chat-messages" #messagesContainer>
    
    <!-- ุฑุณุงูุฉ ุงูุชุฑุญูุจ -->
    <div class="chat-welcome" *ngIf="messages.length === 0">
      <div class="welcome-icon">๐ค</div>
      <h4>ุฃููุงู ุจู ูู ุฎุทูุฉ!</h4>
      <p>ุฃูุง ูุณุงุนุฏู ุงูุฐููุ ููู ูููููู ูุณุงุนุฏุชู ุงููููุ</p>
      <div class="quick-actions">
        <button class="quick-btn" (click)="sendQuickMessage('ููู ุฃุจุฏุฃ ูุดุฑูุนูุ')">ููู ุฃุจุฏุฃ ูุดุฑูุนูุ</button>
        <button class="quick-btn" (click)="sendQuickMessage('ูุง ูู ูููุฒุงุช ุงูููุตุฉุ')">ูููุฒุงุช ุงูููุตุฉ</button>
        <button class="quick-btn" (click)="sendQuickMessage('ูู ุงูููุตุฉ ูุฌุงููุฉุ')">ูู ุงูููุตุฉ ูุฌุงููุฉุ</button>
      </div>
    </div>

    <!-- ุงูุฑุณุงุฆู -->
    <div class="message-wrap" *ngFor="let msg of messages" [class.user-wrap]="msg.isUser">
      <div class="msg-avatar" *ngIf="!msg.isUser">AI</div>
      <div class="message" [class.user-msg]="msg.isUser" [class.bot-msg]="!msg.isUser">
        <p>{{ msg.text }}</p>
        <span class="msg-time">{{ msg.time }}</span>
      </div>
    </div>

    <!-- ูุคุดุฑ ุงููุชุงุจุฉ -->
    <div class="message-wrap" *ngIf="isTyping">
      <div class="msg-avatar">ุฎ</div>
      <div class="message bot-msg typing-indicator">
        <span></span><span></span><span></span>
      </div>
    </div>

  </div>

  <!-- ุญูู ุงูุฅุฏุฎุงู -->
  <div class="chat-input-area">
    <div class="chat-input-wrap">
      <input 
        type="text" 
        class="chat-input" 
        [(ngModel)]="inputText"
        (keydown.enter)="sendMessage()"
        placeholder="ุงูุชุจ ุฑุณุงูุชู ููุง..."
        [disabled]="isTyping"
        #chatInput
      />
      <button class="send-btn" (click)="sendMessage()" [disabled]="!inputText.trim() || isTyping">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <line x1="22" y1="2" x2="11" y2="13"/>
          <polygon points="22 2 15 22 11 13 2 9 22 2"/>
        </svg>
      </button>
    </div>
    <p class="chat-footer-note">ูุฏุนูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู ยท ุฎุทูุฉ</p>
  </div>

</div>

<!-- Overlay ููููุจุงูู -->
<div class="chat-overlay" [class.show]="isChatOpen" (click)="toggleChat()"></div>