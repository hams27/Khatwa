<app-side-bar></app-side-bar>

<div class="financial-container">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner"></div>
    <p>ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช ุงููุงููุฉ...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-banner">
    โ {{ errorMessage }}
  </div>

  <!-- Header -->
  <div class="page-header">
    <h1>๐ฐ ุงููุธุฑุฉ ุงููุงููุฉ</h1>
    <div class="header-actions">
      <!-- Period Selector -->
      <div class="period-selector">
        <button (click)="changePeriod('week')" 
                [class.active]="selectedPeriod === 'week'"
                class="period-btn">
          ุฃุณุจูุน
        </button>
        <button (click)="changePeriod('month')" 
                [class.active]="selectedPeriod === 'month'"
                class="period-btn">
          ุดูุฑ
        </button>
        <button (click)="changePeriod('quarter')" 
                [class.active]="selectedPeriod === 'quarter'"
                class="period-btn">
          ุฑุจุน ุณูุฉ
        </button>
        <button (click)="changePeriod('year')" 
                [class.active]="selectedPeriod === 'year'"
                class="period-btn">
          ุณูุฉ
        </button>
      </div>
      
      <button (click)="refreshFinancialData()" class="btn-refresh">
        ๐ ุชุญุฏูุซ
      </button>
    </div>
  </div>

  <!-- Financial Cards -->
  <div class="cards-grid">
    <div *ngFor="let card of cards" class="financial-card">
      <h3>{{ card.title }}</h3>
      
      <div *ngIf="!card.loading">
        <p class="card-value">{{ card.value }}</p>
        <span class="card-change" 
              [class.positive]="card.up"
              [class.negative]="!card.up">
          {{ card.up ? 'โ' : 'โ' }} {{ card.percent }}
        </span>
      </div>
      
      <div *ngIf="card.loading" class="skeleton-loader"></div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-section">
    
    <!-- Revenue vs Expense Chart -->
    <div class="chart-card">
      <h2>๐ ุงูุฅูุฑุงุฏุงุช ููุงุจู ุงููุตุฑููุงุช</h2>
      <div class="chart-container">
        <canvas #revenueExpenseChart></canvas>
      </div>
    </div>

    <!-- Expense Distribution Chart -->
    <div class="chart-card">
      <h2>๐ฉ ุชูุฒูุน ุงููุตุฑููุงุช</h2>
      <div class="chart-container">
        <canvas #expenseDistributionChart></canvas>
      </div>
    </div>

    <!-- Monthly Trend Chart -->
    <div class="chart-card full-width">
      <h2>๐ ุงูุงุชุฌุงู ุงูุดูุฑู</h2>
      <div class="chart-container">
        <canvas #monthlyTrendChart></canvas>
      </div>
    </div>

    <!-- Profit Margin Chart -->
    <div class="chart-card full-width">
      <h2>๐ ูุงูุด ุงูุฑุจุญ</h2>
      <div class="chart-container">
        <canvas #profitMarginChart></canvas>
      </div>
    </div>
  </div>

  <!-- Recent Transactions -->
  <div class="transactions-section">
    <h2>๐ ุขุฎุฑ ุงููุนุงููุงุช</h2>
    
    <div class="transactions-list">
      <div *ngFor="let transaction of transactions" 
           class="transaction-item"
           [class.revenue]="transaction.type === 'revenue'"
           [class.expense]="transaction.type === 'expense'">
        
        <div class="transaction-icon">
          <span *ngIf="transaction.type === 'revenue'">๐ฐ</span>
          <span *ngIf="transaction.type === 'expense'">๐ธ</span>
          <span *ngIf="transaction.type === 'pending'">โณ</span>
        </div>
        
        <div class="transaction-info">
          <h4>{{ transaction.title }}</h4>
          <span class="transaction-date">{{ transaction.date }}</span>
          <span *ngIf="transaction.category" class="transaction-category">
            {{ transaction.category }}
          </span>
        </div>
        
        <div class="transaction-amount"
             [class.positive]="transaction.amount > 0"
             [class.negative]="transaction.amount < 0">
          {{ transaction.amount > 0 ? '+' : '' }}{{ transaction.amount.toLocaleString('ar-SA') }} ุฑ.ุณ
        </div>
      </div>
      
      <div *ngIf="transactions.length === 0 && !isLoading" class="no-transactions">
        <p>๐ญ ูุง ุชูุฌุฏ ูุนุงููุงุช ูุงููุฉ ุญุชู ุงูุขู</p>
      </div>
    </div>
  </div>
  
</div>