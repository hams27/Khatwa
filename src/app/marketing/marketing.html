<app-side-bar #sidebarRef (collapsedChange)="onSidebarToggle($event)"></app-side-bar>

<!-- ===== TOP NAV ===== -->
<nav class="top-nav" [class.sidebar-collapsed]="isSidebarCollapsed">
  <div class="nav-content">
    <div class="nav-left">
      <div>
        <div class="nav-page-title">ุงูุฎุทุฉ ุงูุชุณููููุฉ</div>
        <div class="nav-page-sub">ุฎุงุฑุทุฉ ุทุฑูู ูุญู ููู ูุดุฑูุนู ูุจูุงุก ุญุถูุฑ ููู</div>
      </div>
    </div>
    <div class="nav-right">
      <div class="nav-date-chip desktop-only">๐ ุงูููู</div>
      <button class="btn-create" (click)="createContent()">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/></svg>
        <span class="btn-text">ุฅูุดุงุก ูุญุชูู</span>
      </button>
      <button class="guide-btn" (click)="openGuide()">
        <svg viewBox="0 0 16 16" fill="white"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/><path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>
        <span class="btn-text">ุฏููู ุงูุงุณุชุฎุฏุงู</span>
      </button>
      <!-- ุฒุฑ ุงููุงูุจุฑุฌุฑ โ ูุธูุฑ ููุท ุนูู ููุจุงูู/ุชุงุจูุช -->
      <button class="topnav-hamburger" (click)="openSidebar()" aria-label="ูุชุญ ุงููุงุฆูุฉ">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>
</nav>

<!-- ===== GUIDE MODAL ===== -->
<div class="modal-overlay" *ngIf="showGuide" (click)="closeGuide()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>๐ฃ ุฏููู ุงุณุชุฎุฏุงู ุงูุฎุทุฉ ุงูุชุณููููุฉ</h3>
      <button class="close-btn" (click)="closeGuide()">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"/></svg>
      </button>
    </div>
    <div class="modal-body">
      <p class="guide-intro">ุงูุฎุทุฉ ุงูุชุณููููุฉ ุชุณุงุนุฏู ุนูู ุจูุงุก ุญุถูุฑ ููู ูุฒูุงุฏุฉ ุงูุชูุงุนู ูุน ุนููุงุฆู.</p>
      <div class="guide-features">
        <div class="guide-item"><span class="guide-icon">๐</span><div><h4>ูุชุงุจุนุฉ ุงูุชูุฏู</h4><p>ุชุงุจุน ุฎุทุชู ุจุดูู ูุฑุฆู ููุงุถุญ</p></div></div>
        <div class="guide-item"><span class="guide-icon">๐ก</span><div><h4>ุฃููุงุฑ ูุญุชูู ุฐููุฉ</h4><p>ุงูุชุฑุงุญุงุช ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</p></div></div>
        <div class="guide-item"><span class="guide-icon">๐</span><div><h4>ุฌุฏููุฉ ุงููุญุชูู</h4><p>ูุธู ููุดุฑ ุงููุญุชูู ุนูู ุฌููุน ุงูููุตุงุช</p></div></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" (click)="closeGuide()">ูููุชุ ุดูุฑุงู</button>
    </div>
  </div>
</div>

<!-- ===== MAIN ===== -->
<main class="marketing-main" [class.sidebar-collapsed]="isSidebarCollapsed">

  <!-- Welcome Banner -->
  <section class="welcome-section">
    <div class="welcome-content">
      <div class="welcome-text">
        <h1 class="welcome-title">ุฎุทุชู ุงูุชุณููููุฉ <span>๐</span></h1>
        <p class="welcome-sub">ุฅุฏุงุฑุฉ ุญุถูุฑู ุงูุฑููู ูุชูููุฉ ุฌูููุฑู ุจุงุญุชุฑุงููุฉ</p>
      </div>
      <div class="welcome-badges">
        <div class="w-badge">
          <span class="w-badge-icon">๐ฃ</span>
          <div><span class="w-badge-lbl">ุญููุงุช ูุดุทุฉ</span><span class="w-badge-val">{{ activeCampaigns }}</span></div>
        </div>
        <div class="w-badge">
          <span class="w-badge-icon">โค๏ธ</span>
          <div><span class="w-badge-lbl">ุฅุฌูุงูู ุงูุชูุงุนู</span><span class="w-badge-val">{{ totalEngagement }}</span></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Metrics -->
  <section class="metrics-grid">

    <div class="mc published">
      <div class="mc-icon">โ</div>
      <div class="mc-lbl">ูุญุชูู ููุดูุฑ</div>
      <div class="mc-val">{{ publishedContent }}</div>
      <div class="mc-trend up" *ngIf="contentGrowth > 0">โ {{ contentGrowth }}%</div>
      <div class="mini-prog"><div class="mini-prog-fill g"></div></div>
    </div>

    <div class="mc scheduled">
      <div class="mc-icon">๐</div>
      <div class="mc-lbl">ูุญุชูู ูุฌุฏูู</div>
      <div class="mc-val">{{ scheduledContent }}</div>
      <div class="mc-sub">ููุฃุณุจูุน ุงููุงุฏู</div>
      <div class="mini-prog"><div class="mini-prog-fill b" style="width:60%"></div></div>
    </div>

    <div class="mc engagement">
      <div class="mc-icon">โค๏ธ</div>
      <div class="mc-lbl">ุฅุฌูุงูู ุงูุชูุงุนู</div>
      <div class="mc-val">{{ totalEngagement }}</div>
      <div class="mini-prog"><div class="mini-prog-fill p" [style.width.%]="engagementProgress"></div></div>
    </div>

    <div class="mc campaigns">
      <div class="mc-icon">๐ฃ</div>
      <div class="mc-lbl">ุญููุงุช ูุดุทุฉ</div>
      <div class="mc-val">{{ activeCampaigns }}</div>
      <div class="mc-sub">{{ daysRemaining }} ููู ูุชุจูู</div>
      <div class="mini-prog"><div class="mini-prog-fill o" style="width:55%"></div></div>
    </div>

  </section>

  <!-- Charts Row -->
  <div class="charts-row">

    <!-- Content Performance Chart (wide) -->
    <div class="chart-card wide">
      <div class="chart-head">
        <div>
          <div class="chart-title">๐ ุฃุฏุงุก ุงููุญุชูู</div>
          <div class="chart-sub">ุงูููุดูุฑุงุช ูุงูุชูุงุนู ุฎูุงู 6 ุฃุดูุฑ</div>
        </div>
        <span class="chip chip-g">โ 23%</span>
      </div>
      <div style="height:240px"><canvas #contentChart></canvas></div>
    </div>

    <!-- Channels Radar -->
    <div class="chart-card">
      <div class="chart-head">
        <div>
          <div class="chart-title">๐ก ุฃุฏุงุก ุงููููุงุช</div>
          <div class="chart-sub">ููุงุฑูุฉ ุงูููุตุงุช</div>
        </div>
      </div>
      <div style="height:240px"><canvas #channelsChart></canvas></div>
    </div>

  </div>

  <!-- Engagement Timeline -->
  <div class="chart-card full-width" style="margin-bottom:24px">
    <div class="chart-head">
      <div>
        <div class="chart-title">๐ ุงูุชูุงุนู ุงููููู</div>
        <div class="chart-sub">ุขุฎุฑ 30 ููู</div>
      </div>
      <span class="chip chip-b">30 ููู</span>
    </div>
    <div style="height:200px"><canvas #engagementChart></canvas></div>
    <div class="chart-foot">
      <div><span class="cs-lbl">ูุชูุณุท ูููู</span><span class="cs-val s">{{ avgDailyEngagement }}</span></div>
      <div><span class="cs-lbl">ุฃุนูู ููู</span><span class="cs-val i">{{ maxDailyEngagement }}</span></div>
    </div>
  </div>

  <!-- Bottom Grid -->
  <div class="bottom-grid">

    <!-- Plan Progress -->
    <div class="card">
      <div class="card-head">
        <div class="card-title">๐ ุชูุฏู ุงูุฎุทุฉ ุงูุชุณููููุฉ</div>
        <span class="prog-pct">{{ planProgress }}%</span>
      </div>

      <!-- Circular Progress -->
      <div class="circ-wrap">
        <div class="circ-container">
          <svg class="circ-svg" viewBox="0 0 120 120">
            <defs>
              <linearGradient id="mktGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#1f9950"/>
                <stop offset="100%" style="stop-color:#00e676"/>
              </linearGradient>
            </defs>
            <circle class="c-bg" cx="60" cy="60" r="50"/>
            <circle class="c-fill" cx="60" cy="60" r="50"
              [style.stroke-dasharray]="314"
              [style.stroke-dashoffset]="314 - (314 * planProgress / 100)"/>
          </svg>
          <div class="circ-center">
            <div class="circ-pct">{{ planProgress }}%</div>
            <div class="circ-lbl">ููุชูู</div>
          </div>
        </div>
      </div>

      <!-- Steps -->
      <div class="steps-list">
        <div class="step-row" *ngFor="let step of marketingSteps; let i = index"
          [class.done]="step.status === 'completed'"
          [class.active]="step.status === 'active'"
          [class.pending]="step.status === 'pending'">
          <div class="step-num">
            <svg *ngIf="step.status === 'completed'" viewBox="0 0 16 16" fill="white"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.97 11.03a.75.75 0 0 0 1.08.022l3.992-4.99a.75.75 0 0 0-1.071-1.05L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06z"/></svg>
            <span *ngIf="step.status !== 'completed'">{{ i + 1 }}</span>
          </div>
          <div class="step-info">
            <div class="step-name">{{ step.title }}</div>
            <div class="step-desc">{{ step.description }}</div>
          </div>
          <span class="step-badge" [class]="step.status">
            {{ step.status === 'completed' ? 'ููุชูู' : step.status === 'active' ? 'ุฌุงุฑู' : 'ูุงุฏู' }}
          </span>
        </div>
      </div>
    </div>

    <!-- Schedule + Actions -->
    <div class="mid-col">

      <!-- Content Schedule -->
      <div class="card">
        <div class="card-head">
          <div class="card-title">๐ ุฌุฏูู ุงููุญุชูู</div>
          <button class="see-all" (click)="viewSchedule()">ุนุฑุถ ุงููู โบ</button>
        </div>
        <div class="schedule-list" *ngIf="scheduledPosts.length > 0; else noSched">
          <div class="sched-item" *ngFor="let post of scheduledPosts">
            <div class="sched-dot" [class]="post.platform"></div>
            <div class="sched-info">
              <div class="sched-title">{{ post.title }}</div>
              <div class="sched-meta">
                <span class="sched-time">๐ {{ post.scheduledTime }}</span>
                <span class="sched-plat" [class]="post.platform">{{ getPlatformLabel(post.platform) }}</span>
              </div>
            </div>
            <span class="sched-status" [class]="post.status">{{ getStatusLabel(post.status) }}</span>
          </div>
        </div>
        <ng-template #noSched>
          <div class="empty-state">
            <div class="empty-icon">๐</div>
            <p>ูุง ุชูุฌุฏ ููุดูุฑุงุช ูุฌุฏููุฉ</p>
            <button class="btn btn-secondary" (click)="createContent()">ุฌุฏููุฉ ูุญุชูู</button>
          </div>
        </ng-template>
      </div>

      <!-- Quick Actions -->
      <div class="card">
        <div class="card-head">
          <div class="card-title">โก ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ</div>
        </div>
        <div class="actions-grid">
          <button class="act-btn analytics" (click)="viewAnalytics()">
            <div class="act-icon">๐</div><span>ุชุญููู ุงูุฃุฏุงุก</span>
          </button>
          <button class="act-btn schedule" (click)="viewSchedule()">
            <div class="act-icon">๐</div><span>ุฌุฏููุฉ ุงูููุดูุฑุงุช</span>
          </button>
          <button class="act-btn campaigns" (click)="viewCampaigns()">
            <div class="act-icon">๐ฃ</div><span>ุงูุญููุงุช ุงููุฏููุนุฉ</span>
          </button>
          <button class="act-btn community" routerLink="/community">
            <div class="act-icon">๐ฌ</div><span>ุงููุฌุชูุน</span>
          </button>
        </div>
      </div>

    </div>

    <!-- AI Content Ideas -->
    <div class="card ideas-card">
      <div class="card-head">
        <div class="card-title">๐ก ุฃููุงุฑ ูุญุชูู ุฐููุฉ</div>
        <span class="ai-badge">AI</span>
      </div>

      <!-- Platform Filter -->
      <div class="platform-tabs">
        <button class="ptab active" (click)="filterPlatform('all')">ุงููู</button>
        <button class="ptab" (click)="filterPlatform('instagram')">๐ท ุงูุณุชุฌุฑุงู</button>
        <button class="ptab" (click)="filterPlatform('facebook')">๐ ููุณุจูู</button>
        <button class="ptab" (click)="filterPlatform('linkedin')">๐ผ ููููุฏ ุฅู</button>
      </div>

      <div class="ideas-list" *ngIf="contentIdeas.length > 0; else noIdeas">
        <div class="idea-item" *ngFor="let idea of contentIdeas" [class]="idea.priority">
          <div class="idea-plat">{{ getPlatformIcon(idea.platform) }}</div>
          <div class="idea-body">
            <div class="idea-title">{{ idea.title }}</div>
            <div class="idea-desc">{{ idea.description }}</div>
            <div class="idea-tags">
              <span class="itag pri" [class]="idea.priority">{{ getPriorityLabel(idea.priority) }}</span>
              <span class="itag type">{{ idea.type }}</span>
            </div>
          </div>
          <button class="idea-use" (click)="useIdea(idea)">
            <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"/></svg>
          </button>
        </div>
      </div>

      <ng-template #noIdeas>
        <div class="empty-state">
          <div class="empty-icon">๐ก</div>
          <p>ุฌุงุฑู ุชูููุฏ ุฃููุงุฑ...</p>
        </div>
      </ng-template>

      <button class="btn-generate" (click)="generateAIContent()" [class.spin]="isGeneratingAI">
        <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/><path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/></svg>
        {{ isGeneratingAI ? 'ุฌุงุฑู ุงูุชูููุฏ...' : 'ุชูููุฏ ุฃููุงุฑ ุฌุฏูุฏุฉ' }}
      </button>
    </div>

  </div><!-- end bottom-grid -->

</main>